# 一行紹介
クロスリンクマーケティングチームが運営するハッピーリークの自動化システム開発

## 버전업 변경점 (filter.py → filterV2.py)

### 1) 입력 데이터/로드 방식 변경
- **filter.py**: CSV 입력 → `pd.read_csv()` (인코딩 자동 감지: utf-8-sig/cp932/utf-8)
- **filterV2.py**: **XLSX 입력** → `pd.read_excel()`  
  - 담당자 제공 데이터 포맷 변경(xlsx)에 맞춰 **xlsx → xlsx** 파이프라인으로 수정
  - 컬럼도 **자동 매핑(pick_col)** 대신 **헤더 고정**(실데이터 기준)

---

### 2) 최저임금 판정 로직 확장/고정(담당자 기준 반영)
- **filter.py**
  - 최저임금 판정은 `unitText + minValue`만 사용
  - **시급(HOUR)**만 자동 비교하여 OK/NG
  - DAY/MONTH/YEAR/WEEK는 전부 **要確認(환산 필요)**

- **filterV2.py**
  - 최저임금 판정은 동일하게 `unitText + minValue`만 사용(給与 텍스트 미사용 유지)
  - **담당자 지정 환산 기준으로 시급 환산 후 OK/NG 자동 판정**
    - 日給(DAY): **8시간** 기준 환산
    - 月給(MONTH): **160시간(8h×20d)** 기준 환산
    - 年収/年俸(YEAR): **1920시간(160h×12m)** 기준 환산
    - 週給(WEEK): **想定外 → 要確認(환산 안 함)**
  - 결과에 **시급 환산값 + 환산 근거(説明/報告용)** 출력
    - `時給換算値(円/時)`, `最低賃金_換算根拠`

---

### 3) 都道府県 처리 방식 개선(보정/추정 추가)
- **filter.py**
  - `都道府県` 컬럼 값이 없거나 매칭 실패 시 **要確認(都道府県不明)**
  - 별도 추정 로직 없음

- **filterV2.py**
  - `都道府県（addressRegion）` 값이 없거나 불명확한 경우 자동 보완
  - 우선순위:
    1) GFJ `都道府県` 값
    2) `勤務地住所`
    3) `市区町村`
    4) (보조) `職種`, `就業先会社名`
  - 추정 근거도 `最低賃金_換算根拠`에 함께 남김

---

### 4) 職種(직종) 판정 기준 “실무형”으로 재정의(과다 NG 방지)
- **filter.py**
  - 특정 키워드(未経験/在宅/募集/고용형태 등)가 포함되면 **요확인**
  - NG는 거의 “공란” 정도만 강하게 처리

- **filterV2.py**
  - **지역명/지명 형태는 NG로 명확히 분리**
    - 都道府県명 포함 → NG
    - `○○区/市/町/村/駅` 형태 포함 → NG
  - **모집/급모/고용형태/근무시간/역할/조건 키워드는 要確認**
    - 모집/조건/역할 등 “직종 외 정보 혼입”으로 보되, 바로 NG로 내리지 않음
  - **시설명은 要確認**(NG 과다 방지)
  - 결과에는 `理由(要約)`로 사유가 남음(추적 가능)

---

### 5) 필수 항목 처리 기준 변경(더 엄격)
- **filter.py**
  - “컬럼이 없음” → 要確認
  - “값 공란” → NG
  - 필수 항목에 `都道府県` 포함

- **filterV2.py**
  - 엑셀 헤더 고정 전제라 “컬럼 없음” 케이스보다 **값 공란을 강하게 NG 처리**
  - 기본 필수 항목: 회사명/고용형태/직종/이메일/市区町村/unitText/minValue
  - `都道府県`는 추정 가능하므로 필수 공란 NG에서 제외(대신 최저임금 파트에서 보완)

---

### 6) 출력(결과 컬럼) 강화
- **filter.py**
  - 최저임금: `都道府県`, `基準値`, `unitText`, `minValue`, `判定根拠` 중심

- **filterV2.py**
  - 최저임금 관련 **실무 검증용 컬럼 추가**
    - `時給換算値(円/時)`
    - `最低賃金_換算根拠` (都道府県 추정 근거 + 환산 근거 포함)
  - 디버그/근거 확인용 원문 컬럼 추가
    - `勤務地住所`, `勤務時間/月平均所定労働時間`, `職種(原文)` 등

---

### 7) 판정 체계 유지(동일)
- 두 버전 모두:
  - 하나라도 NG → **総合 NG**
  - NG 없고 要確認 존재 → **総合 要確認**
  - 전부 OK → **総合 OK**
  - 출력 시트 구성 동일: `審査結果 / NGのみ / 要確認のみ`

---

# filter.py (Japanese Translate version)

## 概要
`filter.py` は、JobMasterList の CSV ファイルを入力として読み込み、  
ハピリク原稿審査基準に基づいて **求人原稿の一次自動フィルタリング** を行うスクリプトです。

各原稿に対して **OK / 要確認 / NG** の判定を行い、  
結果を **Excel（.xlsx）形式** で出力します。

本スクリプトは、人手による本審査の前段階として、  
明確な不備のある原稿を事前に除外し、  
確認が必要な原稿を切り分けることを目的としています。

---

## フィルタリング条件

### 必須項目チェック
- 会社名、雇用形態、職種、メールアドレス、都道府県、給与形態、給与下限
- 値が空欄の場合：**NG**
- 列が存在しない場合：**要確認**

---

### メールアドレス形式
- メール形式が正しくない場合：**NG**

---

### 雇用形態
- 許可されている雇用形態と **完全一致** しない場合：**NG**

---

### 職種名
- 職種以外の条件・広告文言が含まれる場合：**要確認**
- 職種が空欄の場合：**NG**

---

### 会社名表記
- ㈱、(株) などの特殊記号が含まれる場合：**NG**

---

### 非公開求人
- 就業先会社名が「非公開」で、紹介会社名が空欄の場合：**NG**
- 非公開かつ雇用形態が派遣社員の場合：**NG**

---

### 市区町村
- 文字化けの可能性がある場合：**NG**
- 値が空欄の場合：**要確認**

---

### 最低賃金
- `給与形態（unitText）` と `給与下限（minValue）` のみを使用
- **時給（HOUR）** の場合のみ自動判定
- 最低賃金未満の場合：**NG**
- 時給以外の給与形態（日給・月給・年俸など）は：**要確認**

---

## 総合判定ルール
- いずれかが **NG** の場合：総合判定 **NG**
- NG がなく、**要確認** を含む場合：総合判定 **要確認**
- すべて **OK** の場合：総合判定 **OK**

---

# filter.py (Korean Translate version)

## 개요
`filter.py`는 JobMasterList CSV 파일을 입력으로 받아  
하피리크 원고 심사 기준에 따라 **구인 원고를 1차 자동 필터링**하는 스크립트입니다.

각 원고에 대해 **OK / 요확인 / NG** 판정을 수행하고,  
결과를 **Excel(.xlsx)** 파일로 출력합니다.

본 스크립트는 사람 심사 이전 단계에서  
명확한 오류 원고를 사전에 제거하고,  
추가 확인이 필요한 원고를 분리하는 것을 목표로 합니다.

---

## 필터링 조건

### 필수 항목 체크
- 회사명, 고용형태, 직종, 이메일, 도도부현, 급여형태, 급여하한
- 값이 비어 있으면 **NG**
- 컬럼이 없으면 **요확인**

---

### 이메일 형식
- 이메일 형식이 올바르지 않으면 **NG**

---

### 고용형태
- 허용된 고용형태와 **완전 일치**하지 않으면 **NG**

---

### 직종명
- 직종 외 조건·광고 문구가 포함된 경우 **요확인**
- 직종이 비어 있으면 **NG**

---

### 회사명 표기
- ㈱, (株) 등 특수기호가 포함된 경우 **NG**

---

### 비공개 채용
- 회사명이 `비공개`인데 소개회사명이 없으면 **NG**
- 비공개 + 파견직은 **NG**

---

### 시·구·정촌
- 문자 깨짐이 의심되면 **NG**
- 값이 없으면 **요확인**

---

### 최저임금
- `급여형태(unitText)` + `급여하한(minValue)`만 사용
- **시급(HOUR)** 인 경우만 자동 판정
- 최저임금 미만이면 **NG**
- 시급 외 급여형태는 **요확인**

---

## 종합 판정 기준
- 하나라도 **NG** → 종합 **NG**
- NG 없고 요확인 있음 → 종합 **요확인**
- 전부 OK → 종합 **OK**

---